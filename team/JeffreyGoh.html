<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.3">
<title>Jeffrey Goh - Project Portfolio</title>
<link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css">
</head>
<body class="article">
<div id="header">
<h1>Jeffrey Goh - Project Portfolio</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="project-address"><a class="link" href="#project-address">Project: Address++</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Address++ is a desktop address book application primarily targeted at students with projects. Users will interact with it using a CLI, and it has a GUI created with JavaFX. It is written in Java, and has about 10 kLoC.</p>
</div>
<div class="paragraph">
<p><strong>Code contributed</strong>: [<a href="https://github.com/CS2103AUG2017-W09-B2/main/blob/master/collated/main/jeffreygohkw.md">Functional code</a>] [<a href="https://github.com/CS2103AUG2017-W09-B2/main/blob/master/collated/test/jeffreygohkw.md">Test code</a>]</p>
</div>
<div class="sect2">
<h3 id="enhancement-added-privacy-of-fields"><a class="link" href="#enhancement-added-privacy-of-fields">Enhancement Added: Privacy of Fields</a></h3>
<div class="sect3">
<h4 id="external-behavior"><a class="link" href="#external-behavior">External behavior</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="adding-a-person-code-add-code"><a class="link" href="#adding-a-person-code-add-code">Adding a person: <code>add</code></a></h3>
<div class="paragraph">
<p>You can use the <code>add</code> command to add new people to your address book</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>add</code> can be replaced by <code>a</code> for faster input.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Format: <code>add n/NAME p/[PHONE_NUMBER] e/[EMAIL] a/[ADDRESS] r/[REMARK] v/[AVATAR] [t/TAG]&#8230;&#8203;</code><br></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Things To Note</strong><br>
* A person can have any number of tags (including 0)<br>
* The <code>EMAIL</code> should be in the format address@email.domain<br>
* You can set a person&#8217;s <code>Name</code>, <code>Phone</code>, <code>Email</code>, <code>Address</code> and <code>Remark</code>, to be private by placing a <code>p</code> in front of the prefix.<br></p>
</div>
</div>
</div>
<div class="paragraph">
<p><strong>Example Scenarios</strong>:</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Example Scenario 1</strong><br>
Suppose you wanted to add your new friend John Doe. You could type the following command to add his details:</p>
</div>
<div class="paragraph">
<p><code>add n/John Doe p/98765432 e/johnd@example.com a/John street, block 123, #01-01 b/11-11-1995 r/Likes panda bears
v/https://helloworld/image.png</code></p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Example Scenario 2</strong><br>
Now suppose you have another friend named Ima Hidearu, who does not provide you with all the contact information that
you need. You can choose to omit these fields by typing in the command:</p>
</div>
<div class="paragraph">
<p><code>add n/Ima Hidearu a/ e/ p/ r/ v/ t/secretive</code></p>
</div>
</div>
</div>
<div class="sidebarblock">
<div class="content">
<div class="paragraph">
<p><strong>Example Scenario 3</strong><br>
Sometimes, you may wish to keep some fields private (i.e. not reveal them in the application). You can use the private
option while typing in your command:</p>
</div>
<div class="paragraph">
<p><code>add pn/Neville Shorttop pp/46492787 pe/nevilleS@gmail.com pa/Gryphon Gate pr/A true hero</code><br></p>
</div>
<div class="ulist">
<ul>
<li>
<p>Do note that you do not have to set all fields as private, and you can choose which specific fields you want to set as private.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="editing-a-person-code-edit-code"><a class="link" href="#editing-a-person-code-edit-code">Editing a person : <code>edit</code></a></h3>
<div class="paragraph">
<p>You can use the <code>edit</code> command to quickly fix mistakes in your entries, or add/remove details in your contacts. You may wish to edit your contacts when they change their phone numbers, for example.<br>
<code>edit</code> can be replaced by <code>e</code> for faster input.<br>
Format: <code>edit INDEX [n/NAME] [p/PHONE] [e/EMAIL] [a/ADDRESS] [r/REMARK] [v/AVATAR] [t/TAG]&#8230;&#8203;</code><br></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The index refers to the index number shown in the last listing. The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
<li>
<p>You must provide at least one field to edit for each command.</p>
</li>
<li>
<p>Existing values will be updated to the input values.</p>
</li>
<li>
<p>When editing tags, the existing tags of the person will be removed. This means that you cannot cumulatively add tags using multiple <code>edit</code> commands.</p>
</li>
<li>
<p>You can remove all the person&#8217;s tags by typing <code>t/</code> without specifying any tags after it.</p>
</li>
<li>
<p>A private field will not be modified by the Edit command.</p>
</li>
<li>
<p>An Edit command containing only private fields will result in a error message.</p>
</li>
<li>
<p>An Edit command with both private and public fields will only modify the public fields.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit 1 p/91234567 e/johndoe@example.com</code><br>
Edits the phone number and email address of the 1st person to be <code>91234567</code> and <code>johndoe@example.com</code> respectively.</p>
</li>
<li>
<p><code>edit 2 n/Betsy Crower t/</code><br>
Edits the name of the 2nd person to be <code>Betsy Crower</code> and clears all existing tags.</p>
</li>
<li>
<p><code>edit 1 p/</code><br>
Removes the phone number of the 1st person.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Adding <code>task</code> after <code>edit</code> will allow you to edit task details instead. You may wish to edit your task deadlines, for example, when your project schedule changes, or your task priorities, when a task becomes more urgent.<br>
Format: <code>edit task INDEX [n/NAME] [d/DESCRIPTION] [by/DEADLINE] [p/PRIORITY]</code><br></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The index refers to the index number shown in the last listing. The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
<li>
<p>At least one of the optional fields must be provided.</p>
</li>
<li>
<p>Existing values will be updated to the input values.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit task 2 p/5</code><br>
Edits the priority of the 2nd task to be <code>5</code>.</p>
</li>
<li>
<p><code>edit task 2 p/ t/</code><br>
Removes the priority and deadline of the second task.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-privacy-of-a-person-s-details-code-changeprivacy-code-since-v1-3"><a class="link" href="#changing-the-privacy-of-a-person-s-details-code-changeprivacy-code-since-v1-3">Changing the Privacy of a person&#8217;s details : <code>changeprivacy</code>(Since V1.3)</a></h3>
<div class="paragraph">
<p>You can use the <code>changeprivacy</code> command to set the privacy settings for each field of an existing <code>Person</code> in the address book, which allows you to choose specifically what information will be displayed.<br>
<code>changeprivacy</code> can be replaced by <code>cp</code> for faster input.<br></p>
</div>
<div class="paragraph">
<p>Format: <code>changeprivacy INDEX [n/NAME] [p/PHONE] [e/EMAIL] [a/ADDRESS] [r/REMARK] [v/AVATAR]</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>This command allows you to change the privacy settings for the person at the specified <code>INDEX</code>. The index refers to the index number shown in the last person listing. The index <strong>must be a positive integer</strong> 1, 2, 3, &#8230;&#8203;</p>
</li>
<li>
<p>You must provide at least one of the optional fields.</p>
</li>
<li>
<p>You can only provide <code>true</code> or <code>false</code> as inputs after each prefix.</p>
</li>
<li>
<p>If you choose to input <code>false</code>, you will set the privacy of that field for that person to be public. The data in that field will be visible in the UI.</p>
</li>
<li>
<p>If you choose to input <code>true</code>, you will set the privacy of that field for that person to be private. The data in that field cannot be modified and will not be visible in the UI.</p>
</li>
<li>
<p>Fields that do not originally contain any data will still remain empty after changing their privacy.</p>
</li>
<li>
<p>If you do not add a prefix for the field in the command, that field will keep its original privacy setting.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>changeprivacy 1 p/false e/true</code><br>
Sets the phone number of the 1st person to be public and their email address to be private. The 1st person&#8217;s phone number will be displayed, if available, while their email address will be hidden in the UI.</p>
</li>
<li>
<p><code>cp 2 a/false n/true e/false</code><br>
Sets the address and email of the 2nd person to be public and their name to be private. The 2nd person&#8217;s address and email will be displayed, if available, while their name will be hidden in the UI.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-privacy-level-of-the-address-book-code-privacylevel-code-since-v1-5"><a class="link" href="#changing-the-privacy-level-of-the-address-book-code-privacylevel-code-since-v1-5">Changing the Privacy Level of the address book : <code>privacylevel</code>(Since V1.5)</a></h3>
<div class="paragraph">
<p>Changing a person&#8217;s privacy just to reveal their data or to make a person fully confidential may be time-consuming. If you would like to view all the data hidden by private fields easily, or completely hide a person with private fields, you can use this command to change the Privacy Level of the address book.<br>
At level 1, all data, regardless of whether they are set to be private or public, can be viewed.<br>
At level 2, private fields will have their data hidden by a string, such as <code>&lt;Private Phone&gt;</code>.<br>
At level 3, any person containing at least one private field will be completely hidden in the address book.<br>
<code>privacylevel</code> can be replaced by <code>pl</code> for faster input.<br></p>
</div>
<div class="paragraph">
<p>Format: <code>privacylevel [LEVEL]</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Address++ always launches in privacy level 2.</p>
</li>
<li>
<p>The <code>LEVEL</code> that you input can only contain the values 1, 2, or 3.</p>
</li>
<li>
<p>This does not change the actual privacy setting of each field, thus, changing the privacy level to 1 does not make any of the private fields public.</p>
<div class="ulist">
<ul>
<li>
<p>Thus, even if you have set the address book to be privacy level 1, you cannot edit a field that is set as private without setting it back to public.</p>
</li>
<li>
<p>Similarly, since a person is completely hidden in privacy level 3, you will have to set the privacy level back to 2 or 1 to be able to modify that person.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>privacylevel 1</code><br>
Changes the privacy level of the address book to 1, revealing all data hidden by private fields.</p>
</li>
<li>
<p><code>pl 3</code><br>
Changes the privacy level of the address book to 3, hiding all persons with private fields completely in the address book.</p>
</li>
</ul>
</div>
<hr>
<div class="sect3">
<h4 id="justification"><a class="link" href="#justification">Justification</a></h4>
<div class="paragraph">
<p>Users may have contacts that they would like to keep confidential or those that they do not feel comfortable displaying in public. Instead of removing the contact from the address book, setting a field to private allows users to choose exactly what information they would like to display and what they would like to hide.</p>
</div>
<div class="paragraph">
<p>In addition, a private name cannot be searched for, and a private address cannot be used in the locate and navigate commands to prevent users from finding out the value of the private field.</p>
</div>
<div class="paragraph">
<p>Having a private field also doubles up as an extra layer of protection against unintentional modifications, as private fields cannot be edited without changing them back to public fields.</p>
</div>
<div class="paragraph">
<p>It may be inconvenient for a user to set a person&#8217;s fields to public and back to private every time they would like to have a peek at the data that was hidden, or to set a person&#8217;s every field to private if they want to hide them. Thus, having a command to change the privacy level of the address book will make it much more convenient for users to access private information.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation"><a class="link" href="#implementation">Implementation</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="privacy-of-fields"><a class="link" href="#privacy-of-fields">Privacy of fields</a></h3>
<div class="paragraph">
<p>The <code>Name</code>, <code>Phone</code>, <code>Email</code>, <code>Address</code> and <code>Remark</code> of a <code>Person</code> contains a boolean <code>isPrivate</code>, which will determine if the field belonging to that person is private or not.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/PersonClassDiagramPrivacy.png" alt="PersonClassDiagramPrivacy" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.4.1 : Class diagram for a Person, only Name, Phone, Email, Address and Remark contain an isPrivate boolean to indicate if it is private or not</em></p>
</div>
<div class="paragraph">
<p>Adding a person with private fields uses the same <code>AddCommand</code> as adding a person with no public fields.<br>
To determine if the field that is added should be set to private, a <code>p</code> is added to the start of the prefix.<br>
Hence, <code>pe/[EMAIL]</code> will set that person&#8217;s email to be private, whereas if <code>e/[EMAIL]</code> was used, that person&#8217;s email would be public.<br></p>
</div>
<div class="paragraph">
<p>These new prefixes can be found in <code>CliSyntax</code>, and <code>AddCommandParser</code> will take data with these prefixes.
<code>AddCommandParser</code> will then call the appropriate method in <code>ParserUtil</code>, which will parse the string provided into a new field.
Depending on whether or not the field is supposed to be private, <code>ParsetUtil</code> will call the appropriate constructor.
Upon obtaining all the fields anc creating a new <code>Person</code>, <code>AddCommandParser</code> will create a new <code>AddCommand</code> to handle the addition of the new <code>Person</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/AddPrivateSequenceDiagram.png" alt="AddPrivateSequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.4.2 : Sequence Diagram for adding a Person with private fields</em></p>
</div>
<div class="paragraph">
<p>If a field is private, then the <code>toString</code> method will return a string <code>&lt;Private [FIELD]&gt;</code>, where <code>[FIELD]</code> is the name of that field.<br>
This can be seen from the <code>toString</code> method in <code>Name</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">public</span> <span class="predefined-type">String</span> toString() {
    <span class="keyword">if</span> (isPrivate) {
        <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">&lt;Private Name&gt;</span><span class="delimiter">&quot;</span></span>;
    }
    <span class="keyword">return</span> fullName;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Since the information displayed in a person&#8217;s card in the UI gets the value of the field through the <code>toString()</code> method, this hides the actual value of the field in the UI.</p>
</div>
<div class="paragraph">
<p>In addition, if <code>isPrivate</code> is <code>true</code> for <code>Name</code>, clicking on a person&#8217;s card in the UI will not trigger a search on Google for that person&#8217;s name.</p>
</div>
<div class="paragraph">
<p>Instead, a <code>NewResultAvailableEvent</code> will be raised by <code>BrowserPanel</code> to inform the user that they are not allowed to search for a person possessing a private <code>Name</code>.</p>
</div>
<div class="paragraph">
<p>To keep track of whether each field is private or not, <code>XmlAdaptedPerson</code> will have to store the <code>isPrivate</code> value for each field of <code>Person</code>.
This is done by adding the following</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlElement</span>(required = <span class="predefined-constant">true</span>)
   <span class="directive">private</span> <span class="predefined-type">Boolean</span> nameIsPrivate;
<span class="annotation">@XmlElement</span>(required = <span class="predefined-constant">true</span>)
   <span class="directive">private</span> <span class="predefined-type">Boolean</span> phoneIsPrivate;
<span class="annotation">@XmlElement</span>(required = <span class="predefined-constant">true</span>)
   <span class="directive">private</span> <span class="predefined-type">Boolean</span> emailIsPrivate;
<span class="annotation">@XmlElement</span>(required = <span class="predefined-constant">true</span>)
   <span class="directive">private</span> <span class="predefined-type">Boolean</span> addressIsPrivate;
<span class="annotation">@XmlElement</span>(required = <span class="predefined-constant">true</span>)
   <span class="directive">private</span> <span class="predefined-type">Boolean</span> remarkIsPrivate;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which results in a <code>Person</code> being saved in the xml file in the following format</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;persons&gt;</span>
    <span class="tag">&lt;name&gt;</span>Alex Yeoh<span class="tag">&lt;/name&gt;</span>
    <span class="tag">&lt;nameIsPrivate&gt;</span>false<span class="tag">&lt;/nameIsPrivate&gt;</span>
    <span class="tag">&lt;phone&gt;</span>87438807<span class="tag">&lt;/phone&gt;</span>
    <span class="tag">&lt;phoneIsPrivate&gt;</span>false<span class="tag">&lt;/phoneIsPrivate&gt;</span>
    <span class="tag">&lt;email&gt;</span>alexyeoh@example.com<span class="tag">&lt;/email&gt;</span>
    <span class="tag">&lt;emailIsPrivate&gt;</span>false<span class="tag">&lt;/emailIsPrivate&gt;</span>
    <span class="tag">&lt;address&gt;</span>Blk 30 Geylang Street 29, #06-40<span class="tag">&lt;/address&gt;</span>
    <span class="tag">&lt;addressIsPrivate&gt;</span>false<span class="tag">&lt;/addressIsPrivate&gt;</span>
    <span class="tag">&lt;remark&gt;</span>cheerful lad<span class="tag">&lt;/remark&gt;</span>
    <span class="tag">&lt;remarkIsPrivate&gt;</span>false<span class="tag">&lt;/remarkIsPrivate&gt;</span>
    <span class="tag">&lt;tagged&gt;</span>friends<span class="tag">&lt;/tagged&gt;</span>
<span class="tag">&lt;/persons&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If an old save file without privacy data is loaded, then the <code>toModelType()</code> method in <code>XmlAdaptedPerson</code> will set <code>isPrivate</code> to be <code>false</code> for each field of <code>Person</code>, to keep the displayed information the same.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a private field is to be edited by <code>EditCommand</code>, <code>createEditedPerson()</code> in <code>EditCommand</code> will not modify the data of that field, even though <code>EditCommand</code> will create a new <code>CommandResult</code> with a success message.<br>
Hence, a private field will remain private and the value stored by that field will remain the same as it originally was.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is done through the <code>createEditedPerson</code> method in <code>EditCommand</code>.
<code>createEditedPerson</code> sets the boolean <code>areFieldsAllPrivate</code> to initially be true.</p>
</div>
<div class="paragraph">
<p>As the new instance of each field is being generated, if any field contains a value in the input <code>EditPersonDescriptor</code> and that field was not originally private, <code>areFieldsAllPrivate</code> is set to false.</p>
</div>
<div class="paragraph">
<p>This can be seen from the following code, which is used for the generation of a new <code>Name</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">Name</span> createUpdatedName(ReadOnlyPerson personToEdit, EditPersonDescriptor editPersonDescriptor) {
    <span class="predefined-type">Name</span> updatedName;
    <span class="keyword">if</span> (!personToEdit.getName().isPrivate()) {
        updatedName = editPersonDescriptor.getName().orElse(personToEdit.getName());
        <span class="keyword">if</span> (editPersonDescriptor.getName().isPresent()) {
            areFieldsAllPrivate = <span class="predefined-constant">false</span>;
        }
    } <span class="keyword">else</span> {
        updatedName = personToEdit.getName();
    }
    <span class="keyword">return</span> updatedName;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Upon generation of all the fields, if <code>areFieldsAllPrivate</code> is still true, <code>createEditedPerson</code> will throw an <code>IllegalArgumentException</code>, which will cause <code>EditCommand</code> to throw a <code>CommandException</code> and prevent the command from continuing.</p>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Implementation of <code>isPrivate</code><br>
<strong>Alternative 1 (current choice):</strong> Add a boolean to each field class.<br>
<strong>Pros:</strong> Similar implementation to how the fields are currently being implemented. Privacy settings can be obtained directly from the field class itself.<br>
<strong>Cons:</strong> Repetitive code. Additional overloaded constructor and methods are needed to set and get the value of <code>isPrivate</code>. <br>
<strong>Alternative 2:</strong> Store a person&#8217;s privacy settings outside of the field classes in an Array or a HashMap in <code>Person</code>.<br>
<strong>Pros:</strong> Can access and modify the privacy settings of all fields easily.<br>
<strong>Cons:</strong> The fields themselves do not have any indication of whether or not they are private, and will have to check with the <code>Person</code> the belong to.</p>
</div>
<hr>
<div class="paragraph">
<p><strong>Aspect:</strong> How to determine if a field for a newly added person should be private.<br>
<strong>Alternative 1 (current choice):</strong> Add a <code>p</code> to the start of each field&#8217;s prefix to signify that that field should be private.<br>
<strong>Pros:</strong> Can add <code>Person</code> containing any combination of private and public fields in 1 command line.<br>
<strong>Cons:</strong> Have to modify <code>AddCommand</code>, <code>AddCommandParser</code>, <code>ParserUtil</code> and other classes to detect the new prefix and call a separate constructor when a field is private.<br>
<strong>Alternative 2:</strong> A <code>Person</code> is added with all field public, a separate command will then have to be used to set the desired fields to be private.<br>
<strong>Pros:</strong> Easier implementation, do not have to modify <code>AddCommand</code>.<br>
<strong>Cons:</strong> Requires 2 command lines to create a <code>Person</code> with private fields, which takes more time and is more inconvenient for users.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="changing-of-a-person-s-privacy"><a class="link" href="#changing-of-a-person-s-privacy">Changing of a Person&#8217;s Privacy</a></h3>
<div class="paragraph">
<p><code>ChangePrivacyCommand</code> facilitates the setting of an existing person&#8217;s field&#8217;s privacy. Depending on the user&#8217;s input, <code>ChangePrivacyCommand</code> will use each field&#8217;s <code>setPrivate()</code> method to set the value of <code>isPrivate</code>.</p>
</div>
<div class="paragraph">
<p>The sequence diagram for <code>ChangePrivacyCommand</code> is illustrated below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ChangePrivacySequenceDiagram.png" alt="ChangePrivacySequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.5.1 : Sequence Diagram for changing the privacy of a Person&#8217;s fields</em></p>
</div>
<div class="paragraph">
<p>Upon receiving a String containing the arguments from <code>AddressBookParser</code>, <code>ChangePrivacyCommandParser</code> will create a <code>PersonPrivacySettings</code> object.</p>
</div>
<div class="paragraph">
<p>Depending on the input, the <code>ChangePrivacyCommandParser</code> will set the privacy values, represented by Booleans, in the <code>PersonPrivacySettings</code> object to be <code>true</code> or <code>false</code>.</p>
</div>
<div class="paragraph">
<p><code>ChangePrivacyCommandParser</code> will then create a new <code>ChangePrivacyCommand</code> using the input <code>Index</code> and the <code>PersonPrivacySettings</code></p>
</div>
<div class="paragraph">
<p>When <code>ChangePrivacyCommand</code> starts executing, it will create a new <code>Person</code> based on the data of the <code>Person</code> at the specified <code>Index</code>.
It will then adjust the privacy values based on the input <code>PersonPrivacySettings</code>.</p>
</div>
<div class="paragraph">
<p>Once it is done, it will update the original <code>Person</code> with the newly created <code>Person</code> in <code>Model</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If there are missing fields in the input string, the getter methods in <code>PersonPrivacySettings</code> will return <code>false</code>, but the actual value stored will remain as <code>null</code>.
This allows <code>isAnyFieldNonNull</code> to check if the user has input any field at all.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Implementation of changing of a person&#8217;s privacy.<br>
<strong>Alternative 1 (current choice):</strong> Create a separate command to do so.<br>
<strong>Pros:</strong> It is clear to users and developers that <code>changeprivacy</code> is to modify a person&#8217;s privacy while <code>edit</code> changes the actual data if the relevant field is not private. <br>
<strong>Cons:</strong> Additional command, parser and tests must be created. <br>
<strong>Alternative 2:</strong> Enhance the functionality of EditCommand.<br>
<strong>Pros:</strong> Can make use of existing code to aid the implementation.<br>
<strong>Cons:</strong> Increases the complexity of EditCommand for both users and developers. More ambiguous as to how editing a private field will affect the data.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="changing-the-address-book-s-privacy-level"><a class="link" href="#changing-the-address-book-s-privacy-level">Changing the address book&#8217;s privacy level</a></h3>
<div class="paragraph">
<p><code>PrivacyLevelCommand</code> allows the user to change the privacy level of Address++, letting users easily reveal data hidden by private fields, or hide persons containing private fields entirely.</p>
</div>
<div class="paragraph">
<p>The sequence diagram for <code>PrivacyLevelCommand</code> is illustrated below.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/PrivacyLevelSequenceDiagram.png" alt="PrivacyLevelSequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.1 : Sequence Diagram for changing the privacy level of the address book</em></p>
</div>
<div class="paragraph">
<p><code>PrivacyLevelCommandParser</code> will accept any integer that is input in the command line, and create a <code>PrivacyLevelCommand</code> that stores the integer, which represents the privacy level to switch to.</p>
</div>
<div class="paragraph">
<p>Upon execution,<code>PrivacyLevelCommand</code> will first check if the integer falls within the range of the minimum and maximum privacy level. If it does not, a new <code>CommandException</code> is thrown, reminding the user of the valid input levels.</p>
</div>
<div class="paragraph">
<p>If the integer is within the valid range, <code>PrivacyLevelCommand</code> will update the privacy level of <code>Model</code>. Following that, it will proceed to update the privacy level of each person.</p>
</div>
<div class="paragraph">
<p><code>Model</code>, each <code>Person</code> and each field that can be set as private all contain a <code>privacyLevel</code> variable to indicate the current privacy level. This value should remain the same between all of these objects throughout the operation of Address++.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/PersonClassDiagramPrivacyLevel.png" alt="PersonClassDiagramPrivacyLevel" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.6.2 : Class Diagram of Person, which shows which classes contain an integer to indicate the privacy level</em></p>
</div>
<div class="paragraph">
<p>Finally, depending on the privacy level, <code>PrivacyLevelCommand</code> will update the call <code>model.updateFilteredPersonList()</code> with the appropriate predicate.</p>
</div>
<div class="paragraph">
<p>This process is illustrated in the code snippet below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> CommandResult execute() <span class="directive">throws</span> CommandException {
    <span class="keyword">if</span> (level &lt; MIN_PRIVACY_LEVEL || level &gt; MAX_PRIVACY_LEVEL) {
        <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(WRONG_PRIVACY_LEVEL_MESSAGE);
    }
    model.setPrivacyLevel(level);
    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; model.getAddressBook().getPersonList().size(); i++) {
        ReadOnlyPerson toReplace = model.getPersonAtIndexFromAddressBook(i);
        Person newPerson = <span class="keyword">new</span> Person(toReplace);
        newPerson.setPrivacyLevel(level);
        <span class="keyword">try</span> {
            model.updatePerson(toReplace, newPerson);
        } <span class="keyword">catch</span> (DuplicatePersonException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(MESSAGE_DUPLICATE_PERSON);
        } <span class="keyword">catch</span> (PersonNotFoundException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">AssertionError</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">The target person cannot be missing</span><span class="delimiter">&quot;</span></span>);
        }
    }
    <span class="keyword">if</span> (level == <span class="integer">3</span>) {
        model.updateFilteredPersonList(<span class="keyword">new</span> ShowAllPrivacyLevelPredicate());
    } <span class="keyword">else</span> {
        model.updateFilteredPersonList(Model.PREDICATE_SHOW_ALL_PERSONS);
    }
    <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(CHANGE_PRIVACY_LEVEL_SUCCESS, <span class="predefined-type">Integer</span>.toString(level)));
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Storing of the privacy level<br>
<strong>Alternative 1 (current choice):</strong> Have each relevant class store a privacy level integer.<br>
<strong>Pros:</strong> Less coupling, less modification of existing code required. <br>
<strong>Cons:</strong> Have to modify every relevant object every time <code>PrivacyLevelCommand</code> is called. Runs the risk that an object may accidentally not have its privacy level modified to match the other objects if privacy levels are not properly updated.<br>
<strong>Alternative 2:</strong> Store the privacy level in the model and have any object that needs to check it query from model.<br>
<strong>Pros:</strong> Only one integer needs to be modified for the privacy level of the entire address book to change, which also eliminates any possibility that privacy level may be different when used by different objects.<br>
<strong>Cons:</strong> Increases coupling, classes such as Name will need to have a Model object as one of its variables to access Model. Large scale modification of existing code and tests are necessary.</p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-locating-a-person-s-address"><a class="link" href="#enhancement-added-locating-a-person-s-address">Enhancement Added: Locating a person&#8217;s address</a></h3>
<div class="sect3">
<h4 id="external-behavior-2"><a class="link" href="#external-behavior-2">External behavior</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="locating-a-person-s-address-code-locate-code-since-v1-4"><a class="link" href="#locating-a-person-s-address-code-locate-code-since-v1-4">Locating a person&#8217;s address : <code>locate</code> (Since V1.4)</a></h3>
<div class="paragraph">
<p>If you ever need to visit one of your contacts, you can use <code>locate</code> to choose a contact, and search for their address online using Google Maps.<br>
<code>locate</code> can be replaced by <code>loc</code> for faster input.<br>
Format (person): <code>locate INDEX</code><br></p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>list</code><br>
<code>locate 2</code><br>
Locates the address of the 2nd person in the address book on Google Maps.</p>
</li>
<li>
<p><code>find Betsy</code><br>
<code>locate 1</code><br>
Locates the address of the 1st person in the results of the <code>find</code> command on Google Maps.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Depending on the stored value of the address, Google Maps may be unable to find the correct address or may display multiple addresses of the same name.<br></p>
<div class="ulist">
<ul>
<li>
<p>It is up to you to provide specific and valid addresses.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A person with a private address cannot be searched on Google Maps.</p>
</li>
<li>
<p>A person with no address will open Google Maps, but it will not search for an address as there is no address to search for.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing.</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> <code>1, 2, 3, &#8230;&#8203;</code> and must be within the range of people in the most recent listing.</p>
</li>
</ul>
</div>
</div>
</div>
<hr>
<div class="sect3">
<h4 id="justification-2"><a class="link" href="#justification-2">Justification</a></h4>
<div class="paragraph">
<p>While a person&#8217;s phone and email address can be used directly, users often are unaware of where exactly their contacts' addresses are located in real life. The locate command aims to solve this problem by taking the address of a contact and searching for it on Google Maps. This allows the user to find out where exactly their contacts' addresses are located.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-2"><a class="link" href="#implementation-2">Implementation</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="locating-a-person-on-google-maps"><a class="link" href="#locating-a-person-on-google-maps">Locating a Person on Google Maps</a></h3>
<div class="paragraph">
<p>Upon calling the <code>locate</code> command, <code>LocateCommandParser</code> will parse the input string into an <code>Index</code>, and create a new <code>LocateCommand</code>. Should the arguments be a non-integer, a <code>ParseException</code> will be thrown.<br>
This can be seen from the code snippet below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="directive">public</span> LocateCommand parse(<span class="predefined-type">String</span> args) <span class="directive">throws</span> <span class="exception">ParseException</span> {
    <span class="keyword">try</span> {
        Index index = ParserUtil.parseIndex(args);
        <span class="keyword">return</span> <span class="keyword">new</span> LocateCommand(index);
    } <span class="keyword">catch</span> (IllegalValueException ive) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(
                <span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, LocateCommand.MESSAGE_USAGE));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Upon execution of <code>LocateCommand</code>, it will search the <code>Model</code> for the <code>Person</code> at the input <code>Index</code>. If the <code>Index</code> is out of range of the list of <code>Person`s, a `CommandException</code> will be thrown.</p>
</div>
<div class="paragraph">
<p>Otherwise, <code>LocateCommand</code> will post a new <code>BrowserPanelLocateEvent</code> and pass in the <code>Person</code> found to that event. It will then return a <code>CommandResult</code> indicating the success of its execution.</p>
</div>
<div class="paragraph">
<p>This code for this can be found below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
    <span class="directive">public</span> CommandResult execute() <span class="directive">throws</span> CommandException {

        <span class="predefined-type">List</span>&lt;ReadOnlyPerson&gt; lastShownList = model.getFilteredPersonList();

        <span class="keyword">if</span> (targetIndex.getZeroBased() &gt;= lastShownList.size()) {
            <span class="keyword">throw</span> <span class="keyword">new</span> CommandException(Messages.MESSAGE_INVALID_PERSON_DISPLAYED_INDEX);
        }

        EventsCenter.getInstance().post(<span class="keyword">new</span> BrowserPanelLocateEvent(
                model.getFilteredPersonList().get(targetIndex.getZeroBased())));
        <span class="keyword">return</span> <span class="keyword">new</span> CommandResult(<span class="predefined-type">String</span>.format(MESSAGE_LOCATE_PERSON_SUCCESS, targetIndex.getOneBased()));

    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>BrowserPanel will then use <code>handleBrowserPanelLocationEvent</code> to process this newly created event. It will call <code>loadMapsPage</code>, which will check if the <code>Person&#8217;s `Address</code> is private or not. If their <code>Address</code> is public, it will launch the browser, showing the <code>Address</code> of that <code>Person</code> on Google Maps. Otherwise, an error message will be printed, as can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"> <span class="directive">private</span> <span class="type">void</span> loadMapsPage(ReadOnlyPerson person) {
    <span class="keyword">if</span> (person.getAddress().isPrivate()) {
        raise(<span class="keyword">new</span> NewResultAvailableEvent(PRIVATE_ADDRESS_CANNOT_SEARCH));
    } <span class="keyword">else</span> {
        loadPage(GOOGLE_MAPS_URL_PREFIX + person.getAddress().toString().replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">+</span><span class="delimiter">&quot;</span></span>)
            + GOOGLE_MAPS_URL_SUFFIX);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The overall sequence of events is illustrated by the following sequence diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/LocateSequenceDiagram.png" alt="LocateSequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.7.1 : Sequence Diagram for Locating a Person&#8217;s Address</em></p>
</div>
<div class="sect3">
<h4 id="design-considerations-4"><a class="link" href="#design-considerations-4">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> Implementation of the Google Maps to search for a person&#8217;s <code>Address</code><br>
<strong>Alternative 1 (current choice):</strong> Create a separate command <code>locate</code>.<br>
<strong>Pros:</strong> No modification needed for existing commands, which makes it clear the purpose of each command.<br>
<strong>Cons:</strong> Additional commands will need to be learnt for both developers and users.<br>
<strong>Alternative 2:</strong> Add the functionality into <code>SelectCommand</code>.<br>
<strong>Pros:</strong> Expands the utility of <code>SelectCommand</code> beyond performing a Google search on their name.<br>
<strong>Cons:</strong> Will require significant modification of existing code, and may make it more confusing for users.</p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-navigating-from-one-address-to-another"><a class="link" href="#enhancement-added-navigating-from-one-address-to-another">Enhancement Added: Navigating from one address to another</a></h3>
<div class="sect3">
<h4 id="external-behavior-3"><a class="link" href="#external-behavior-3">External behavior</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="navigating-from-one-address-to-another-code-navigate-code-since-v1-5"><a class="link" href="#navigating-from-one-address-to-another-code-navigate-code-since-v1-5">Navigating from one address to another : <code>navigate</code> (Since V1.5)</a></h3>
<div class="paragraph">
<p>Although <code>locate</code> shows you where a person&#8217;s address is, it does not tell you how to get there. The <code>navigate</code> command will provide directions, with the help of Google Maps, on how to get from one address to another.<br>
<code>navigate</code> can be replaced by <code>nav</code> for faster input.<br>
Format (person): <code>navigate [fp/INDEX] [ft/INDEX] [fa/ADDRESS] (Must have only one of three) [tp/INDEX] [tt/INDEX] [ta/ADDRESS] (Must have only one of three)</code><br></p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>navigate fa/NUS tp/1</code><br>
Opens Google Maps to provide directions on how to navigate from NUS to the address of the first person in the address book.</p>
</li>
<li>
<p><code>navigate  fp/3 tt/2</code><br>
Opens Google Maps to provide directions on how to navigate from the address of the third person in the address book to the address of the second task in the address book.</p>
</li>
<li>
<p><code>navigate  ft/1 ta/Changi Airport</code><br>
Opens Google Maps to provide directions on how to navigate from the address of the first task in the address book to Changi Airport.</p>
</li>
</ul>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Depending on the stored value of the address, Google Maps may be unable to find the correct address or may display multiple addresses of the same name.<br></p>
<div class="ulist">
<ul>
<li>
<p>It is up to you to provide specific and valid addresses.</p>
</li>
</ul>
</div>
</li>
<li>
<p>A person with a private address or a person with no address cannot be navigated from or navigated to.</p>
</li>
<li>
<p>A task with no address cannot be navigated from or navigated to.</p>
</li>
<li>
<p>The index refers to the index number shown in the most recent listing.</p>
</li>
<li>
<p>The index <strong>must be a positive integer</strong> <code>1, 2, 3, &#8230;&#8203;</code> and must be within the range of people in the most recent listing.</p>
</li>
<li>
<p>You may only input exactly one of the 3 prefixes from <code>fp/</code> <code>ft/</code> and <code>fa/</code> to indicate the address to navigate from, and exactly one of the 3 prefixes from <code>tp/</code> <code>tt/</code> and <code>ta/</code> to indicate the address to navigate to.</p>
<div class="ulist">
<ul>
<li>
<p>If you input any less or any more than 1 of the 3 prefixes from each group, the command will fail.</p>
</li>
<li>
<p>There is no need to match the type of prefixes. You can navigate with any combination of prefixes as long as there is only one prefix to indicate the address to navigate from and only one prefix to indicate the address to navigate to.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<hr>
<div class="sect3">
<h4 id="justification-3"><a class="link" href="#justification-3">Justification</a></h4>
<div class="paragraph">
<p>Locating a contact does not tell users how to arrive at that particular contact&#8217;s address. Furthermore, users may face the scenario where they have to travel and meet different groups and different contacts throughout the day. The Navigate command allows users to find out the most efficient path from one address to another with the aid of Google Maps.</p>
</div>
<div class="paragraph">
<p>Users are able to utilize the addresses attached to a person, as well as those attached to a task, in the navigate command. They can also manually input addresses in the custom line if they are looking for directions to or from an address that is not presently stored inside the address book. This greatly enhances the flexibility of the command, and allows users to use the command without having to add a dummy task or person to store new addresses beforehand.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-3"><a class="link" href="#implementation-3">Implementation</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="navigating-from-one-address-to-another-using-google-maps"><a class="link" href="#navigating-from-one-address-to-another-using-google-maps">Navigating from one address to another using Google Maps</a></h3>
<div class="paragraph">
<p>When the <code>navigate</code> command is entered into the command line, <code>NavigateCommandParse</code> will first reset its internal <code>from</code>, <code>to</code>, <code>fromIndex</code>, <code>toIndex</code> to null. It will then check for the input prefixes and ensure that only one of the prefixes from the group <code>fp/</code>, <code>ft/</code>, and <code>fa/</code>, which we will subsequently call the <code>from</code> prefixes are present. It then does the same with the prefixes from the group <code>tp/</code>, <code>tt/</code> and <code>ta/</code>, which we will call the <code>to</code> prefixes.<br></p>
</div>
<div class="paragraph">
<p>This is done by invoking the <code>checkFrom</code> and <code>checkTo</code> methods as can be seen from the code snippet below. For the example <code>checkFrom</code>, it takes in 3 booleans on whether or not each prefix is present and checks whether or not there is exactly one kind of <code>from</code> prefix. It throws an error if there are no <code>from</code> prefixes or more than one type of <code>from</code> prefixes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> checkFrom(ArgumentMultimap argumentMultimap, <span class="type">boolean</span> fromAddress, <span class="type">boolean</span> fromPerson, <span class="type">boolean</span> fromTask)
        <span class="directive">throws</span> <span class="exception">ParseException</span> {
    <span class="keyword">if</span> (!(fromAddress || fromPerson || fromTask)) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(<span class="predefined-type">String</span>.format(MESSAGE_INVALID_COMMAND_FORMAT, NavigateCommand.MESSAGE_USAGE));
    } <span class="keyword">else</span> <span class="keyword">if</span> ((fromAddress &amp;&amp; (fromPerson || fromTask)) || (fromPerson &amp;&amp; fromTask)) {
        <span class="comment">// If 2 or more from prefixes are present</span>
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(NavigateCommand.MESSAGE_MULTIPLE_FROM_ERROR);
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            setArgsForNavigateCommand(argumentMultimap, fromAddress, fromPerson, <span class="predefined-constant">true</span>);
        } <span class="keyword">catch</span> (IllegalValueException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">ParseException</span>(e.getMessage(), e);
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>checkFrom</code> calls <code>setArgsForNavigateCommand</code>, which sets the variables in the <code>NavigateCommandParser</code> to the appropriate values depending on whether the address originates from a person, a task or is a manual input by the user.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> setArgsForNavigateCommand(ArgumentMultimap argumentMultimap, <span class="type">boolean</span> address, <span class="type">boolean</span> person, <span class="type">boolean</span> forFrom) <span class="directive">throws</span> IllegalValueException {
    <span class="keyword">if</span> (address) {
        <span class="keyword">if</span> (forFrom) {
            from = <span class="keyword">new</span> Location(ParserUtil.parseLocationFromAddress(
                    argumentMultimap.getValue(PREFIX_NAVIGATE_FROM_ADDRESS)).get().toString());
        } <span class="keyword">else</span> {
            to = <span class="keyword">new</span> Location(ParserUtil.parseLocationFromAddress(
                    argumentMultimap.getValue(PREFIX_NAVIGATE_TO_ADDRESS)).get().toString());
        }
    } <span class="keyword">else</span> <span class="keyword">if</span> (person) {
        <span class="keyword">if</span> (forFrom) {
            fromIndex = ParserUtil.parseIndex(argumentMultimap
                    .getValue(PREFIX_NAVIGATE_FROM_PERSON).get());
        } <span class="keyword">else</span> {
            toIndex = ParserUtil.parseIndex(argumentMultimap
                    .getValue(PREFIX_NAVIGATE_TO_PERSON).get());
        }
    } <span class="keyword">else</span> {
        <span class="keyword">if</span> (forFrom) {
            fromIndex = ParserUtil.parseIndex(argumentMultimap
                    .getValue(PREFIX_NAVIGATE_FROM_TASK).get());
        } <span class="keyword">else</span> {
            toIndex = ParserUtil.parseIndex(argumentMultimap
                    .getValue(PREFIX_NAVIGATE_TO_TASK).get());
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, <code>NavigateCommandParser</code> will create a new <code>NavigateCommand</code> based on the inputs as set by <code>setArgsForNavigateCommand</code>.</p>
</div>
<div class="paragraph">
<p>When <code>NavigateCommand</code> is created, it first checks if there are duplicate <code>from</code> or <code>to</code> addresses that are passed into it and throws an error if that is the case.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> checkDuplicateFromAndToLocation(Location locationFrom, Location locationTo, Index fromIndex, Index toIndex) <span class="directive">throws</span> <span class="exception">IllegalArgumentException</span> {
    <span class="keyword">if</span> (locationFrom != <span class="predefined-constant">null</span> &amp;&amp; fromIndex != <span class="predefined-constant">null</span>) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(MESSAGE_MULTIPLE_FROM_ERROR);
    }
    <span class="keyword">if</span> (locationTo != <span class="predefined-constant">null</span> &amp;&amp; toIndex != <span class="predefined-constant">null</span>) {
        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(MESSAGE_MULTIPLE_TO_ERROR);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If it passes this check, <code>NavigateCommand</code> stores <code>fromLocation</code> and <code>toLocation</code>, which are the Locations of any manually added address by the user to navigate from and to respectively. It also stores <code>toIndex</code> and <code>fromIndex</code>, which are the Indexes of the <code>Person</code> or <code>Task</code> to extract the address from as well as <code>toIsTask</code> and <code>fromIsTask</code>, which are booleans that indicate whether <code>toIndex</code> and <code>fromIndex</code> are indexes of Persons or Tasks.</p>
</div>
<div class="paragraph">
<p>Upon execution of <code>NavigateCommmand</code>, it will first check if it has a non-null <code>fromIndex</code>, if it does, it will create a new Location based on its <code>fromIndex</code> and <code>fromIsTask</code> values using the <code>setLocationByIndex</code> method. Otherwise, it will set the Location to be the Location in <code>locationfrom</code>. This can be seen below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (fromIndex != <span class="predefined-constant">null</span>) {
        <span class="keyword">try</span> {
            from = setLocationByIndex(fromIndex, fromIsTask);
        } <span class="keyword">catch</span> (IllegalValueException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(MESSAGE_PRIVATE_PERSON_ADDRESS_ERROR);
        }
    } <span class="keyword">else</span> {
        from = locationFrom;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>setLocationByIndex throws Exceptions if the target Person or Task does not have a valid Address to extract.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (fromIndex != <span class="predefined-constant">null</span>) {
        <span class="keyword">try</span> {
            from = setLocationByIndex(fromIndex, fromIsTask);
        } <span class="keyword">catch</span> (IllegalValueException e) {
            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(MESSAGE_PRIVATE_PERSON_ADDRESS_ERROR);
        }
    } <span class="keyword">else</span> {
        from = locationFrom;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>NavigateCommand</code> does the same for the Address to navigate <code>To</code> and posts a new <code>BrowserPanelNavigateEvent</code>, passing in the <code>Location</code> to navigate <code>From</code> and the <code>Location</code> to navigate <code>To</code>.<br>
<code>NavigateCommand</code> will then create a new <code>CommandResult</code> to indicate a successful <code>Command</code>.</p>
</div>
<div class="paragraph">
<p><code>BrowserPanel</code> will then get the information from this <code>BrowserPanelNavigateEvent</code>, and load the appropriate Google Maps URL after replacing information such as the Unit Number and extra whitespaces. This has to be done as Google Maps does not function properly with Unit Numbers or spaces in its URL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> loadDirectionsPage(<span class="predefined-type">String</span> fromLocation, <span class="predefined-type">String</span> toLocation) {
    loadPage(GOOGLE_MAPS_DIRECTIONS_PREFIX + <span class="string"><span class="delimiter">&quot;</span><span class="content">&amp;origin=</span><span class="delimiter">&quot;</span></span>
            + fromLocation.replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">#(</span><span class="char">\\</span><span class="content">w+)</span><span class="char">\\</span><span class="content">s*</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>).replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">+</span><span class="delimiter">&quot;</span></span>)
            .replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">-(</span><span class="char">\\</span><span class="content">w+)</span><span class="char">\\</span><span class="content">s*</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
            + <span class="string"><span class="delimiter">&quot;</span><span class="content">&amp;destination=</span><span class="delimiter">&quot;</span></span>
            + toLocation.replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">#(</span><span class="char">\\</span><span class="content">w+)</span><span class="char">\\</span><span class="content">s*</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>).replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content"> </span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">+</span><span class="delimiter">&quot;</span></span>)
            .replaceAll(<span class="string"><span class="delimiter">&quot;</span><span class="content">-(</span><span class="char">\\</span><span class="content">w+)</span><span class="char">\\</span><span class="content">s*</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="delimiter">&quot;</span></span>)
            + GOOGLE_MAPS_DIRECTIONS_SUFFIX);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The overall sequence of events is illustrated by the following sequence diagram:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/NavigateSequenceDiagram.png" alt="NavigateSequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.8.1 : Sequence Diagram for Navigating from one Address to another</em></p>
</div>
<div class="sect3">
<h4 id="design-considerations-5"><a class="link" href="#design-considerations-5">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> How to pass the appropriate information to NavigateCommand<br>
<strong>Alternative 1 (current choice):</strong> Have a constructor that takes in a large number of arguments so that NavigateCommand can correctly identify what kind of Location to post in BrowserPanelNavigateEvent.<br>
<strong>Pros:</strong> Only 1 constructor needed.<br>
<strong>Cons:</strong> Additional methods will be needed to properly identify which Location to use for navigation. <br>
<strong>Alternative 2:</strong> Create many constructors to segregate the different possible scenarios that might happen.<br>
<strong>Pros:</strong> It is clear what information to use to generate the Locations<br>
<strong>Cons:</strong> Requires large numbers of constructors to be created, easy for mistakes to occur as Constructors all share the same name but different argument types.</p>
</div>
<div class="paragraph">
<p><strong>Aspect:</strong> How to transfer information of the address from one class to another<br>
<strong>Alternative 1 (current choice):</strong> Wrap the address in a <code>Location</code> class before posting the BrowserPanelNavigateEvent.<br>
<strong>Pros:</strong> Only Locations, which indicates that the address is properly parsed, will be passed for the BrowserPanel to read, reducing the possibility of BrowserPanel reading stray unwanted strings as addresses to navigate to and from. The value stored inside each Location cannot be altered once that Location object has been created.<br>
<strong>Cons:</strong> A new class has to be created and Strings, Addresses and TaskAddresses will need to be converted to Locations first. <br>
<strong>Alternative 2:</strong> Simply pass on a String containing the address from class to class<br>
<strong>Pros:</strong> Easy to read and transfer information, lower overhead<br>
<strong>Cons:</strong> It is easier for stray Strings to pollute the information, and the Strings can be unintentionally modified.</p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="enhancement-added-opening-and-saving-of-the-xml-save-file"><a class="link" href="#enhancement-added-opening-and-saving-of-the-xml-save-file">Enhancement Added: Opening and Saving of the .xml save file</a></h3>
<div class="sect3">
<h4 id="external-behavior-4"><a class="link" href="#external-behavior-4">External behavior</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="opening-a-save-file-code-open-code"><a class="link" href="#opening-a-save-file-code-open-code">Opening a save file : <code>open</code></a></h3>
<div class="paragraph">
<p>Switching between address books is made easy with the <code>open</code> command, as it allows you can load different save files into the application.<br>
You can choose which .xml file to open from the pop up window that appears upon executing this command.<br>
<code>open</code> can be replaced by <code>o</code> for faster input.<br>
Format <code>open</code></p>
</div>
</div>
<div class="sect2">
<h3 id="saving-the-data-as-a-new-save-file-code-save-code"><a class="link" href="#saving-the-data-as-a-new-save-file-code-save-code">Saving the data as a new save file : <code>save</code></a></h3>
<div class="paragraph">
<p>If you would like to save a copy of your data in a separate location or with a different name, the <code>save</code> command will allow you to do just that.<br>
You can choose what to name your save file and where to save it from the pop up window that appears upon executing this command.<br>
<code>save</code> can be replaced by <code>sa</code> for faster input.<br>
Format: <code>save</code></p>
</div>
</div>
<div class="sect2">
<h3 id="saving-the-data"><a class="link" href="#saving-the-data">Saving the data</a></h3>
<div class="paragraph">
<p>Address book data is saved in the hard disk automatically after any command that changes the data.<br>
There is no need for you to save manually.</p>
</div>
<div class="paragraph">
<p>If you want to change the location of the save file, you can use the <code>save</code> command, click on <code>File &#8594; Save As</code> or use the keyboard shortcut <kbd>CTRL</kbd>+<kbd>S</kbd> and select the new location and file name for the save file in the pop-up window.</p>
</div>
<div class="paragraph">
<p>If you want to open a different save file, you can use the <code>open</code> command, click on <code>File &#8594; Open</code> or use the keyboard shortcut <kbd>CTRL</kbd>+<kbd>O</kbd> and select the new save file to use from the pop-up window.</p>
</div>
<hr>
<div class="sect3">
<h4 id="justification-4"><a class="link" href="#justification-4">Justification</a></h4>
<div class="paragraph">
<p>Open and Save As will allow users to more easily manage their data. Open allows them to load their data from a .xml file, letting them easily work on multiple different address books.<br>
Save As allows users to save their address book data, letting it serve as backup or allowing them to be placed in a different location on the computer while still remaining operational.<br>
This also allows for easier transfers of save files between devices without having to manually drag and manage the save files to and from the folder where Address++ is located.
It can even potentially allow for syncing save files between devices if external software like Dropbox is used.</p>
</div>
</div>
<div class="sect3">
<h4 id="implementation-4"><a class="link" href="#implementation-4">Implementation</a></h4>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="opening-and-saving-of-the-xml-save-file"><a class="link" href="#opening-and-saving-of-the-xml-save-file">Opening and Saving of the .xml save file</a></h3>
<div class="paragraph">
<p>Both <code>OpenCommand</code> and <code>SaveAsCommand</code> function in a very similar way.
When <code>open</code> or <code>save</code> is input by the user, <code>AddressBookParser</code> will create a new <code>OpenCommand</code> or <code>SaveAsCommand</code>.</p>
</div>
<div class="paragraph">
<p>These two commands will then post a new <code>OpenRequestEvent</code> or a new <code>SaveAsRequestEvent</code> and return a successful <code>CommandResult</code>.</p>
</div>
<div class="paragraph">
<p><code>MainWindow</code> will have two methods, <code>HandleOpenRequestEvent</code> and <code>HandleSaveAsRequestEvent</code> that subscribe to the above two events and will call <code>handleOpen</code> and <code>handleSaveAs</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> handleOpen() <span class="directive">throws</span> <span class="exception">IOException</span>, DataConversionException {
    <span class="comment">// Set extension filter</span>
    FileChooser.ExtensionFilter extFilter = <span class="keyword">new</span> FileChooser.ExtensionFilter(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">XML files (*.xml)</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">*.xml</span><span class="delimiter">&quot;</span></span>);
    fileChooser.getExtensionFilters().add(extFilter);

    <span class="comment">// Show open file dialog</span>
    <span class="predefined-type">File</span> file = fileChooser.showOpenDialog(primaryStage);
    <span class="keyword">if</span> (file != <span class="predefined-constant">null</span>) {
        <span class="comment">// Change file path to the opened file</span>
        storage.changeFilePath(file.getPath(), prefs);
        <span class="comment">// Reset data in the model to the data from the opened file</span>
        model.resetData(XmlFileStorage.loadDataFromSaveFile(file));
        <span class="comment">// Update the UI</span>
        fillInnerParts();
    }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="type">void</span> handleSaveAs() <span class="directive">throws</span> <span class="exception">IOException</span> {
    <span class="comment">// Set extension filter</span>
    FileChooser.ExtensionFilter extFilter = <span class="keyword">new</span> FileChooser.ExtensionFilter(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">XML files (*.xml)</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">*.xml</span><span class="delimiter">&quot;</span></span>);
    fileChooser.getExtensionFilters().add(extFilter);

    <span class="comment">// Show save file dialog</span>
    <span class="predefined-type">File</span> file = fileChooser.showSaveDialog(primaryStage);

    <span class="keyword">if</span> (file != <span class="predefined-constant">null</span>) {
        <span class="comment">// Make sure it has the correct extension</span>
        <span class="keyword">if</span> (!file.getPath().endsWith(<span class="string"><span class="delimiter">&quot;</span><span class="content">.xml</span><span class="delimiter">&quot;</span></span>)) {
            file = <span class="keyword">new</span> <span class="predefined-type">File</span>(file.getPath() + <span class="string"><span class="delimiter">&quot;</span><span class="content">.xml</span><span class="delimiter">&quot;</span></span>);
        }
        <span class="comment">// Change file path to the new save file</span>
        storage.changeFilePath(file.getPath(), prefs);
        <span class="comment">// Save the address book data and the user preferences</span>
        storage.saveAddressBook(model.getAddressBook());
        storage.saveUserPrefs(prefs);
        <span class="comment">// Update the UI</span>
        fillInnerParts();
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both <code>handleOpen</code> and <code>handleSaveAs</code> will create a new <code>FileChooser</code> extension filter that only allows the pop-up window to save files and load files in the .xml format.</p>
</div>
<div class="paragraph">
<p>Upon successfully selecting a file to load or a location to save as in the pop-up window, both methods will call <code>changefilepath</code> in <code>Storage</code> to the selected file path.</p>
</div>
<div class="paragraph">
<p>Finally, both commands diverge as <code>handleOpen</code> will call <code>resetData</code> to reset the data using the new save file, while <code>handleSaveAs</code> will call <code>saveAddressBook</code> and <code>saveUserPrefs</code> to save the data. Both methods will finally call <code>fillInnerParts()</code> to refresh the data displayed on the UI.</p>
</div>
<div class="paragraph">
<p>This process is illustrated using the sequence diagram below:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/OpenSequenceDiagram.png" alt="OpenSequenceDiagram" width="800">
</div>
</div>
<div class="paragraph">
<p><em>Figure 3.8.1 : Sequence Diagram for Opening a save file</em></p>
</div>
<div class="sect3">
<h4 id="design-considerations-6"><a class="link" href="#design-considerations-6">Design Considerations</a></h4>
<div class="paragraph">
<p><strong>Aspect:</strong> How does <code>OpenCommand</code> and <code>SaveAsCommand</code> determine the file location to save or load the save file from<br>
<strong>Alternative 1 (current choice):</strong> Open a <code>FileChooser</code> window, allowing the user to move through their file directory to acquire their save location and to select the name of the save file.<br>
<strong>Pros:</strong> User friendly, many other applications function similarly when saving and loading. Easier to implement and use as part of the dropdown menu in the User Interface.<br>
<strong>Cons:</strong> Not entirely command line based. <br>
<strong>Alternative 2:</strong> Input the file directory and file name to save or load from as part of the command.<br>
<strong>Pros:</strong> Entirely command line based, may be more preferable for users who prefer using the command line.<br>
<strong>Cons:</strong> Requires more complex code. Command must check if the file location to save or load from is valid, and that there is a valid file of that name.</p>
</div>
<hr>
</div>
</div>
<div class="sect2">
<h3 id="other-contributions"><a class="link" href="#other-contributions">Other contributions</a></h3>
<div class="ulist">
<ul>
<li>
<p>Add Menu Icons for Open, Save As, Exit and Help (Pull request <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/10">#10</a>)</p>
</li>
<li>
<p>Add Keyboard Shortcuts for Open, Save As, Exit and Help (Pull request <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/10">#11</a>, <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/101">#101</a>)</p>
</li>
<li>
<p>Modified SortCommand to be undoable, and wrote test cases for it (Pull requests <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/29">#29</a>, <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/30">#30</a>)</p>
</li>
<li>
<p>Created TaskAddress to store the address of tasks (Pull requests <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/129">#129</a>, <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/132">#132</a>)</p>
</li>
<li>
<p>Added Travis, Coveralls and Appveyor links for Continuous Integration (Pull requests <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/4">#4</a>, <a href="https://github.com/CS2103AUG2017-W09-B2/main/pull/22">#22</a>)</p>
</li>
<li>
<p>Performed Acceptance Testing for Team T16-B2 (Issue <a href="https://github.com/CS2103AUG2017-T16-B2/main/issues/102">#102</a>)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2017-11-11 12:11:36 +00:00
</div>
</div>
</body>
</html>